<p align="middle" >
  <img width="200px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/a771c542-bebb-4846-8d35-d337b6ab8333"/>
</p>
<h1 align="middle">VECTO</h1>
<h3 align="middle">데이트 경로 공유 SNS </h3>
<br/>

## 🙋‍♂️ Developer  
|                                          Frontend                                           |                                         Backend                                          |                                         Backend                                          |             
| :----------------------------------------------------------------------------------------: | :--------------------------------------------------------------------------------------: | :--------------------------------------------------------------------------------------
|  |  |  | 
|                            [심준보](https://github.com/Vecto-Konkuk)                            |                           [손찬혁](https://github.com/hyeokson)                           |                          [백종현](https://github.com/jhbaik1501)                          |

개발 기간: 2023.09 ~ 2023.12

## 📝 프로젝트 소개

Vecto 애플리케이션은 사용자들의 데이트 경로를 공유할 수 있는 SNS입니다.  
연인간의 데이트 경로뿐만 아니라, 하루동안 사용자들이 경험한 다양한 장소 및 경로를 공유할 수 있습니다.  
앱은 Play Store에서 다운받을 수 있습니다.  
<p align="middle" >
<img width="200px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/0dfced33-b985-4e4c-b535-cd435132dab7"/>
</p>

</br>

**<기대 효과>**  
**1) 신뢰할 수 있는 방문지 리뷰**  
사용자의 위치를 GPS로 추적하여 실제로 방문한 장소와 경로만 게시글에 올릴 수 있습니다.  
따라서 광고성 리뷰 또는 광고료를 받고 작성된 대가성 리뷰는 제공하지 않으므로 사용자들은 신뢰할 수 있는 데이트 경로 정보를 사용할 수 있습니다.    

**2) 서로 소통할 수 있는 SNS**  
일반적인 SNS처럼 사용자들이 작성한 게시글을 팔로우, 댓글, 좋아요 기능을 통해 서로 소통할 수 있고 게시글의 정보를 평가할 수 있습니다.  
또한, 질 좋은 정보를 제공하는 사용자는 팔로잉을 많이 받을 수 있고 게시글의 좋아요를 많이 받으므로 다른 사용자들이 질 좋은 정보를 제공할 수 있는 동기부여를 제공할 수 있고, 사용자들이 데이트 코스를 선택하는 기준을 제공해줍니다.    

**3) 추천 방문지 및 데이트 경로 제공**  
방문지를 검색했을 때, 방문지에 대한 리뷰와 정보뿐만 아니라 인근의 다른 추천 방문지들이 코스로 제공되기 때문에 개별 방문지들을 검색하는 것보다 더 효율적으로 질 좋은 컨텐츠를 제공받을 수 있습니다.    


<br/>



## 🔧 Stack

**Deploy**  

<img src="https://img.shields.io/badge/Amazon EC2-FF9900?style=for-the-badge&logo=Amazon EC2&logoColor=white"/> <img src="https://img.shields.io/badge/Amazon rds-527FFF?style=for-the-badge&logo=Amazon rds&logoColor=white"/>  

**Frontend(App)**
- **Language**
  
  <img src="https://img.shields.io/badge/Kotlin-7F52FF?style=for-the-badge&logo=Kotlin&logoColor=white"/>
  
- **Library & Framework**

  <img src="https://img.shields.io/badge/android studio-3DDC84?style=for-the-badge&logo=android studio&logoColor=white"/>
  
- **Database**

  <img src="https://img.shields.io/badge/sqlite-003B57?style=for-the-badge&logo=sqlite&logoColor=white"/>
<br />

**Backend**
- **Language**

  <img src="https://img.shields.io/badge/java-FF4C46?style=for-the-badge&logo=java&logoColor=white"/>
  
- **Library & Framework**

  <img src="https://img.shields.io/badge/spring boot-6DB33F?style=for-the-badge&logo=spring boot&logoColor=white"/>
  <img src="https://img.shields.io/badge/gmail server-EA4335?style=for-the-badge&logo=gmail server&logoColor=white"/>
  <img src="https://img.shields.io/badge/firebase-FFCA28?style=for-the-badge&logo=firebase&logoColor=white"/>
  <img src="https://img.shields.io/badge/spring security-6DB33F?style=for-the-badge&logo=spring security&logoColor=white"/>
  <img src="https://img.shields.io/badge/Amazon s3-569A31?style=for-the-badge&logo=Amazon s3&logoColor=white"/>
  
- **Database**

  <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white"/>
  
- **ORM**

  <img src="https://img.shields.io/badge/jpa-0064FF?style=for-the-badge&logo=jpa&logoColor=white"/>  

<br/>

## 🔨 프로젝트 구조도

<img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/9ed4ed87-db45-4aae-b827-465e5db509ca"/>

<br/>

## ⭐ UI 및 주요 기능

- **메인 화면**
  
  메인 화면인 탐색 화면에서 검색어를 통해 원하는 장소나 키워드에 해당하는 게시글을 확인 할 수 있습니다.
  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/26156908-e82a-4a84-82e4-bc3bcdc5eea8"/>

- **게시글 상세 화면**

  게시글을 선택하면 게시글 상세 페이지로 이동할 수 있습니다.  
  데이트 코스와 이미지 및 상세정보를 확인할 수 있고, 좋아요와 댓글을 통해 소통할 수 있습니다.
  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/9e8aedcd-735d-416f-a873-a54789e6b8e1"/>
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/15e8f2c8-08ac-43e9-8739-df305777fde5"/>

- **게시글 작성 화면**

  바텀 네비게이션의 글쓰기 아이콘 선택을 통해 게시글 작성 화면으로 이동할 수 있습니다.  
  데이트 경로, 사진, 제목, 글을 작성하여 등록하면 게시글 작성이 완료됩니다.  
  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/ffbcf421-3092-4bc5-ae18-35dd96405ffc"/>

- **권한 설정 화면**

  바텀 네비게이션의 위치 수집항목 아이콘 선택을 통해 권한 설정 화면으로 이동할 수 있습니다.  
  사용자 권한 설정이 처음이라면 가이드 화면을 따라가면서 권한 설정을 할 수 있습니다.  

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/9496cf29-3d61-4df1-aff2-aac5377f3083"/>

- **경로 수집 화면**

  권한 설정이 모두 완료되면 GPS를 통해 유저의 이동 경로 및 방문지 정보를 수집할 수 있습니다.

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/651d3647-e1b3-4939-a4e4-b1f0dcc77979"/>

- **경로 수정 화면**

  바텀 네비게이션의 경로 수정 아이콘 선택을 통해 경로 수정 화면으로 이동할 수 있습니다.  
  처음에 나오는 달력을 통해 방문지가 저장된 날짜를 확인할 수 있고, 해당 날짜를 선택하여 이동경로 및 방문지를 수정할 수 있습니다.  
  방문지를 선택하면 방문지 이름 수정, 방문지 삭제, 주변 방문지 검색 기능을 사용할 수 있습니다.  
  이동 경로를 선택하면 화면 하단에서 방문지들을 순서대로 확인할 수 있고, 추천 경로 설정 기능을 통해 이동 경로를 바꿀 수 있습니다.  

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/f4cb2759-1f8b-4eec-a246-fbaa6c5d3a14"/>  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/67bea202-bfaf-4f2c-bb58-82353389f27a"/>  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/aa1ca2c5-1441-4833-af1a-b3467294bda6"/>  

- **마이페이지 화면**

  바텀 네비게이션의 마이페이지 아이콘 선택을 통해 마이페이지로 이동할 수 있습니다.  
  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/eeabf54b-025e-45a4-af5e-03174c42df9c"/>

- **로그인 및 회원가입 화면**

  VECTO 전용 계정 또는 카카오 계정으로 로그인할 수 있습니다.  
  VECTO 전용 계정으로 로그인하려면 회원가입을 진행해야 합니다.

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/04d217da-31ef-4cea-96bb-ccba186715ae"/>  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/56d6647a-da92-4258-b93c-080fc3bc83cf"/>

- **알림 화면**

  다른 유저가 자신의 게시글에 댓글을 달거나 팔로우를 할 경우, 알림을 확인할 수 있습니다.

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/4845b861-2278-4c8e-a7a6-6fc14beb1964"/>

- **댓글 화면**

  게시글에 댓글을 작성할 수 있고, 댓글에 좋아요를 누를 수 있습니다.

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/a8dfb449-1f87-4aa7-8b7c-9815a45d152f"/>

- **유저 프로필 화면**  

  해당 화면에서 유저를 팔로우할 수 있고 유저의 상세 정보들을 확인할 수 있습니다.
  유저의 부적절한 행동을 발견할 경우, 해당 유저를 신고할 수도 있습니다.

  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/ca9eb3a9-c9e3-4888-8e88-ff0349605198"/>  
  <img width="600px;" src="https://github.com/Vecto-Konkuk/spring-backend/assets/127181634/3b84173f-f85c-4146-ae17-9e93d57eab74"/>  

</br>

## 📱 Android
- **백그라운드 위치 수집 기능**  
  백그라운드에서 사용자의 위치 수집을 위해 Service를 사용하여 위치 수집 정보를 수집합니다.  
  백그라운드 작업이 시작되면, 백그라운드에서 동작 중이라는 알림이 발생하고 위치 수집을 시작합니다.  
  GPS 정보의 정확도가 50M 이내인 정보만 유효한 데이터로 사용되고, 이 외의 데이터는 사용하지 않습니다.  
  GPS 정보가 5분 이상 반경 50M 이내에 위치하게 된다면, 방문으로 판단하여 방문지 Database에 저장합니다.  
  방문지의 위도 경도 값은 50M 이내에 위치한 값들의 평균 값으로 판단합니다.  
  경로 편집 작업을 위해 경로, 방문지 정보는 SQLite를 사용하여 Loacl Database에 저장합니다.  

- **알림 기능**  
  FCM을 사용하여 백그라운드 알림 기능을 구현하였습니다.  
  이를 위해 로그인을 할 때, 서버에게 사용자 ID, Password 정보와 함께 FCM Token 값을 전달합니다.  
  BroadcastReceiver와 LocalBroadcastManager를 사용하여, 앱 사용 중 새로운 알림이 발생하였을 때 알림 아이콘 UI 갱신을 수행하도록 하였습니다.  
  Intent를 사용하여, 사용자가 댓글 및 팔로우 알림을 확인할 경우, 댓글의 경우에는 해당 댓글 화면으로, 팔로우의 경우에는, 해당 사용자의 정보 화면으로 이동하도록 구현하였습니다.  

- **이미지 업로드**  
  S3 서버에 이미지를 업로드하는 경우, Bitmap Compress를 사용하여 이미지 압축을 진행하여 업로드를 수행하도록 구현하였습니다.  

- **게시글 불러오기**  
  Paging을 사용하여 게시글을 20개씩 가져오도록 구현하였습니다.  
  첫 게시글인 경우 중단, 추가 게시글일 경우 하단에 Progress Bar를 사용하여 사용자에게 게시글 정보 로딩 중을 알릴 수 있도록 구현하였습니다.  
  ViewModel에 모든 게시글 정보를 저장하는 MutableList를 통해, Adapter와의 데이터 동기화를 수행하도록 구현하였습니다.  
  탐색 화면에서, BottomNavigation의 탐색 아이콘을 재선택하면, 게시글 목록의 최상단으로 이동하도록 구현하였습니다.  
  탐색 화면에서, VECTO 로고를 선택하면, 검색 및 게시글 상태를 새로고침 합니다.  
  SwipeRefreshLayout을 사용하여, 게시글을 아래로 스와이프 하여 새로고침할 수 있도록 구현하였습니다.  

- **좋아요 및 팔로우 기능**  
  게시글 좋아요 및 팔로우 요청은 Retrofit을 사용하여 비동기적으로 처리되고, 결과에 따라 게시글 정보가 수정되는 방식으로 구현하였습니다.  
  좋아요 추가의 요청의 경우, 애니메이션을 추가하여 사용자의 좋아요 참여를 유도하도록 구현하였습니다.  

- **경로 편집 기능**  
  HashSet을 사용하여 사용자가 날짜를 선택할 때, 방문지 데이터가 존재하는 날짜만 선택할 수 있도록 구현하였습니다.  

- 경로 수정 
  추천 경로 설정을 통해 Tmap 보행자 경로 API를 사용하여 이상적인 경로로 변경할 수 있습니다.  

- 방문지 수정  
  네이버 지도의 Symbol ClickListener를 사용하여, 방문지 정보를 수정할 수 있도록 하였습니다.  
  Symbol에 존재하지 않는 방문지를 위하여, 방문지 데이터 상에 위치한 장소에 사용자가 원하는 방문지 명을 사용할 수 있도록 구현하였습니다.  
  TMap 주변검색 기능 API를 사용하여, 반경 100M 이내의 장소를 검색하고, 이를 TedNaverMapClustering을 사용하여 클러스터링을 구현하였습니다.  

- 방문지 삭제  
  단순히 삭제하는 것이 아닌, 직전과 직후 방문지를 확인하여, 100M 이내의 거리에 위치한 방문지라면, 노이즈로 인해 생긴 추가 방문지로 판단하여, 방문지 데이터와 병합을 수행합니다.  
  방문지에 머무른 시간 정보인 Staytime을 갱신하고, 이전 방문지와 병합되었으면, 삭제된 방문지의 종료 시간을 사용하고, 이후 방문지와 병합되었으면, 삭제된 방문지의 시작 시간을 사용하여 병합을 수행합니다.  

## 💻 Server
- **[Server API(Swagger)]**: https://vec-to.net/swagger-ui/index.html
  
- **로그인 및 인증 기능**  
  애플리케이션을 위한 Restful API 서버를 개발해야하기 때문에 세션, 쿠키가 필요없는 JWT 인증방식을 사용했습니다.  
  그리고 인증 방식을 쉽고 안전하게 구현하기 위해서 Spring Security를 사용하여 인증체계를 구축했습니다.  
  Username and Password Authentication Mechanism 을 사용하지 않으므로 JwtAuthenticationFilter를 따로 만들어서 JWT를 인증할 수 있도록 개발했습니다.  
  로그인을 하게 되면 프론트에 JWT를 반환하고 그 후의 request에서 header에 JWT를 넣으면 서버의 여러 기능들을 사용할 수 있습니다.  

- **게시글 및 댓글 기능**  
  FeedController를 통해서 게시글과 댓글의 CRUD 기능을 구현했습니다.  
  애플리케이션의 게시글 탐색 화면에서 게시글을 조회할 때는 Paging을 사용하여 DB에서 정보를 가져왔고, 로그인 상태와 비로그인 상태를 구별해서 게시글 정보를 반환하도록 구현했습니다.  
  로그인 상태에서는 팔로우를 한 유저의 게시글을 조회하고 나서 팔로우를 하지 않은 유저의 게시글을 조회할 수 있습니다.  
  비로그인 상태에서는 처음부터 팔로우 여부와 관계없이 시간 순서대로 게시글을 조회할 수 있습니다.  

- **팔로우 및 좋아요 기능**  
  각각 FollowController, LikesController, CommentLikesController가 CRUD를 담당합니다.  
  팔로우 및 게시글 좋아요 기능을 사용하게 되면 해당 유저에게 푸쉬알림이 가도록 구현했습니다.  
  푸쉬알림은 Firebase의 Cloud Messaging 기능을 사용해서 팔로우 및 좋아요 기능을 사용한 직후에 바로 유저의 앱에 알림이 뜨게 됩니다.  

- **이미지 저장 기능**  
  ImageController에서 게시글 사진과 프로필 사진 저장 및 조회 기능을 담당합니다.  
  이미지 파일은 용량이 크기 때문에 Amazon S3를 활용하여 이미지를 저장하고, 해당 이미지 URL을 프론트에 보내주게 됩니다.  
  
</br>

## 💾 ERD  

- **유저 정보 테이블을 중심으로 한 ERD**
  
<img width="600px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/4d5c36f3-19c6-4526-874c-941c3b704ea7"/>

- **팔로우 테이블 ERD**

  <img width="600px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/5ff787c2-880e-484d-ad5a-625b969c105a"/>

- **게시글 테이블을 중심으로 한 ERD**
  
  <img width="600px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/0364f80c-299f-4d84-ae3a-cd1c455693b9"/>
  <img width="600px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/c4dafeb5-9a3b-4ffc-866a-1ad79ed9eb5b"/>
  <img width="600px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/537b1476-81d6-4e19-89b5-b6da0df35544"/>
  <img width="400px;" src="https://github.com/hyeokson/spring-backend/assets/127181634/826bc286-0ca6-4ec3-b1e1-ed15b4ef9ff3"/>





  

  




  

